<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Markdown Viewer (MathJax + marked)</title>

  <!-- Basic styling -->
  <link rel="stylesheet" href="styles.css">

  <!-- Local marked (must exist in repo root) -->
  <script src="./marked.min.js"></script>

  <!-- MathJax config (must appear before MathJax script) -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        packages: {'[+]': ['ams']}
      },
      options: {
        // prevent MathJax from scanning inside these tags
        skipHtmlTags: ['script','noscript','style','textarea','pre','code']
      },
      svg: { fontCache: 'global' },
      startup: { pageReady: () => Promise.resolve() }
    };
  </script>

  <!-- MathJax (defer is fine) -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <!-- highlight.js -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/styles/default.min.css">
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js"></script>

  <!-- mermaid -->
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>

  <!-- your script (defer so MathJax + marked present) -->
  <script defer src="script.js"></script>
</head>
<body>
  <div class="app" data-theme="light">
    <header>
      <div class="title">Markdown Viewer (MathJax + marked)</div>
      <div class="muted" style="margin-left:8px">Render math, mermaid & code</div>

      <div class="controls" style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <input id="urlInput" type="text" placeholder="Raw GitHub URL (raw.githubusercontent.com) or any raw .md url" style="width:420px" />
        <button id="loadUrlBtn" class="btn">Load URL</button>
        <input id="fileInput" type="file" accept=".md,.markdown,text/markdown" />
        <button id="toggleTheme" class="btn">Toggle Theme</button>
        <button id="downloadPdf" class="btn">Print / Save PDF</button>
      </div>
    </header>

    <div id="container" style="display:flex; height:calc(100vh - 60px);">
      <aside id="sidebar" style="width:260px; border-right:1px solid rgba(0,0,0,0.06); padding:12px; overflow:auto; background:var(--card);">
        <div style="font-weight:600">Contents</div>
        <div id="toc" class="toc muted">No headings loaded yet</div>
        <div class="drop-hint" style="margin-top:8px; color:var(--muted); font-size:0.9rem;">Tip: drag & drop a .md file anywhere on the page</div>
      </aside>

      <main id="main" style="flex:1; overflow:auto; padding:20px;">
        <div id="viewer" aria-live="polite" style="max-width:900px; margin:0 auto;">
          Drop a Markdown file or open a raw URL to render.
        </div>
      </main>
    </div>
  </div>
</body>
</html>
