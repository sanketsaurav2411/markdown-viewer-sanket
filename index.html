<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Markdown Viewer (MathJax + marked)</title>

  <!-- Basic styling (small, neutral) -->
  <style>
    :root{
      --bg:#fff; --fg:#111; --muted:#666; --card:#f8f8f8;
    }
    [data-theme="dark"]{
      --bg:#0b0c0f; --fg:#e6e7e9; --muted:#9aa0a6; --card:#0f1114;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    .app {
      display:flex; flex-direction:column; height:100vh;
    }
    header { display:flex; gap:12px; align-items:center; padding:10px 14px; background:var(--card); box-shadow:0 1px 0 rgba(0,0,0,0.04); }
    header .title { font-weight:600; }
    header .controls { margin-left:auto; display:flex; gap:8px; align-items:center; }
    #container { display:flex; flex:1; overflow:hidden; }
    #sidebar { width:260px; border-right:1px solid rgba(0,0,0,0.06); padding:12px; overflow:auto; background:var(--card); }
    #main { flex:1; overflow:auto; padding:20px; }
    #viewer { max-width:900px; margin:0 auto; }
    pre { background:#0b0c0f; color:#e6e7e9; padding:10px; overflow:auto; border-radius:6px; }
    pre code { white-space:pre; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; }
    .toc a{ display:block; color:var(--fg); text-decoration:none; padding:4px 0; font-size:0.95rem; }
    .muted { color:var(--muted); font-size:0.9rem; }
    .btn { background:transparent; border:1px solid rgba(0,0,0,0.08); padding:6px 10px; border-radius:6px; cursor:pointer; }
    input[type="text"]{ padding:6px 8px; border-radius:6px; border:1px solid rgba(0,0,0,0.08); }
    .drop-hint { font-size:0.9rem; color:var(--muted); margin-top:8px; }
    @media (max-width:900px){ #sidebar{display:none;} }
  </style>

  <!-- MathJax config (must appear before MathJax script) -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        packages: {'[+]': ['ams']}
      },
      options: {
        skipHtmlTags: ['script','noscript','style','textarea','pre','code']
      },
      svg: { fontCache: 'global' },
      startup: { pageReady: () => Promise.resolve() }
    };
  </script>

  <!-- Marked (exact commit you referenced) -->
  <script src="https://cdn.jsdelivr.net/gh/markedjs/marked@52e445f6ee41f151e247f9cf8add54786efae88e/marked.min.js"></script>

  <!-- MathJax script -->
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <!-- highlight.js -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/styles/default.min.css">
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js"></script>

  <!-- mermaid -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>

  <!-- your script -->
  <script defer src="script.js"></script>
</head>
<body>
  <div class="app" data-theme="light">
    <header>
      <div class="title">Markdown Viewer (MathJax + marked)</div>
      <div class="muted" style="margin-left:8px">Render math, mermaid, code</div>

      <div class="controls">
        <input id="urlInput" type="text" placeholder="Raw GitHub URL (raw.githubusercontent.com) or any raw .md url" style="width:420px"/>
        <button id="loadUrlBtn" class="btn">Load URL</button>
        <input id="fileInput" type="file" accept=".md,.markdown" />
        <button id="toggleTheme" class="btn">Toggle Theme</button>
        <button id="downloadPdf" class="btn">Print / Save PDF</button>
      </div>
    </header>

    <div id="container">
      <aside id="sidebar">
        <div style="font-weight:600">Contents</div>
        <div id="toc" class="toc muted">No headings loaded yet</div>
        <div class="drop-hint">Tip: drag & drop a .md file anywhere on the page</div>
      </aside>

      <main id="main">
        <div id="viewer" aria-live="polite">Drop a Markdown file or open a raw URL to render.</div>
      </main>
    </div>
  </div>
</body>
</html>
